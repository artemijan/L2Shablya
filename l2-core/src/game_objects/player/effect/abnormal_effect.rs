use num_enum::{IntoPrimitive, TryFromPrimitive};
use strum::{EnumIter, IntoEnumIterator};
use strum_macros::Display;

#[derive(Debug, Clone,Copy, Eq, PartialEq, Hash, IntoPrimitive, TryFromPrimitive, EnumIter, Display)]
#[repr(u16)]
pub enum AbnormalVisualEffect {
    DotBleeding = 1,
    DotPoison = 2,
    DotFire = 3,
    DotWater = 4,
    DotWind = 5,
    DotSoil = 6,
    Stun = 7,
    Sleep = 8,
    Silence = 9,
    Root = 10,
    Paralyze = 11,
    FleshStone = 12,
    DotMp = 13,
    BigHead = 14,
    DotFireArea = 15,
    ChangeTexture = 16,
    BigBody = 17,
    FloatingRoot = 18,
    DanceRoot = 19,
    GhostStun = 20,
    Stealth = 21,
    Seizure1 = 22,
    Seizure2 = 23,
    MagicSquare = 24,
    Freezing = 25,
    Shake = 26,
    UltimateDefence = 28,
    VpUp = 29,
    RealTarget = 30,
    DeathMark = 31,
    TurnFlee = 32,
    Invincibility = 33,
    AirBattleSlow = 34,
    AirBattleRoot = 35,
    ChangeWp = 36,
    ChangeHairG = 37, // Gold Afro
    ChangeHairP = 38, // Pink Afro
    ChangeHairB = 39, // Black Afro
    Unknown40 = 40,
    StigmaOfSilen = 41,
    SpeedDown = 42,
    FrozenPillar = 43,
    ChangeVesS = 44,
    ChangeVesC = 45,
    ChangeVesD = 46,
    TimeBomb = 47,
    MpShield = 48,
    Airbind = 49,
    Changebody = 50,
    Knockdown = 51,
    NavitAdvent = 52,
    Knockback = 53,
    Change7anniversary = 54,
    OnSpotMovement = 55,
    Deport = 56,
    AuraBuff = 57,
    AuraBuffSelf = 58,
    AuraDebuff = 59,
    AuraDebuffSelf = 60,
    Hurricane = 61,
    HurricaneSelf = 62,
    BlackMark = 63,
    BrSoulAvatar = 64,
    ChangeGradeB = 65,
    BrBeamSwordOnehand = 66,
    BrBeamSwordDual = 67,
    NoChat = 68,
    HerbPaUp = 69,
    HerbMaUp = 70,
    SeedTalisman1 = 71,
    SeedTalisman2 = 72,
    SeedTalisman3 = 73,
    SeedTalisman4 = 74,
    SeedTalisman5 = 75,
    SeedTalisman6 = 76,
    CuriousHouse = 77,
    NgradeChange = 78,
    DgradeChange = 79,
    CgradeChange = 80,
    BgradeChange = 81,
    AgradeChange = 82,
    SweetIceFlakes = 83,
    FantasyIceFlakes = 84,
    ChangeXmas = 85,
    CardPcDeco = 86,
    ChangeDinos = 87,
    ChangeValentine = 88,
    Chocolate = 89,
    Candy = 90,
    Cookie = 91,
    Stars0 = 92,
    Stars1 = 93,
    Stars2 = 94,
    Stars3 = 95,
    Stars4 = 96,
    Stars5 = 97,
    Dueling = 98,
    Freezing2 = 99,
    ChangeYogi = 100,
    Yogi = 101,
    MusicalNoteYellow = 102,
    MusicalNoteBlue = 103,
    MusicalNoteGreen = 104,
    TenthAnniversary = 105,
    XmasSocks = 106,
    XmasTree = 107,
    XmasSnowman = 108,
    OthellRogueBluff = 109,
    HeProtect = 110,
    SuSumcross = 111,
    WindStun = 112,
    StormSign2 = 113,
    StormSign1 = 114,
    WindBlend = 115,
    DeceptiveBlink = 116,
    WindHide = 117,
    PsyPower = 118,
    Squall = 119,
    WindIllusion = 120,
    SayhaFury = 121,
    Hide4 = 123,
    PmentalTrail = 124,
    HoldLighting = 125,
    GravitySpace3 = 126,
    Spaceref = 127,
    HeAspect = 128,
    RunwayArmor1 = 129,
    RunwayArmor2 = 130,
    RunwayArmor3 = 131,
    RunwayArmor4 = 132,
    RunwayArmor5 = 133,
    RunwayArmor6 = 134,
    RunwayWeapon1 = 135,
    RunwayWeapon2 = 136,
    PaladinProtection = 141,
    SentinelProtection = 142,
    RealTarget2 = 143,
    Divinity = 144,
    ShillienProtection = 145,
    EventStars0 = 146,
    EventStars1 = 147,
    EventStars2 = 148,
    EventStars3 = 149,
    EventStars4 = 150,
    EventStars5 = 151,
    AbsorbShield = 152,
    PhoenixAura = 153,
    RevengeAura = 154,
    EvasAura = 155,
    TemplarAura = 156,
    LongBlow = 157,
    WideSword = 158,
    BigFist = 159,
    ShadowStep = 160,
    Tornado = 161,
    SnowSlow = 162,
    SnowHold = 163,
    TornadoSlow = 165,
    AstatineWater = 166,
    BigBodyCombinationCatNpc = 167,
    BigBodyCombinationUnicornNpc = 168,
    BigBodyCombinationDemonNpc = 169,
    BigBodyCombinationCatPc = 170,
    BigBodyCombinationUnicornPc = 171,
    BigBodyCombinationDemonPc = 172,
    BigBody2 = 173,
    BigBody3 = 174,
    PirateSuit = 175,
    DarkAssassinSuit = 176,
    WhiteAssassinSuit = 177,
    AveDragonUltimate = 181,
    InfiniteShield1Ave = 183,
    InfiniteShield2Ave = 184,
    InfiniteShield3Ave = 185,
    InfiniteShield4Ave = 186,
    AveAbsorb2Shield = 187,
    TaliDecoBaium = 190,
    ChangeshapeTransform = 193,
    AngryGolemAve = 194,
    WaUnbreakableSonicAve = 195,
    HeroicHolyAve = 196,
    HeroicSilenceAve = 197,
    HeroicFearAve1 = 198,
    HeroicFearAve2 = 199,
    AveBrooch = 200,
    InfiniteShield4Ave2 = 206,
    ChangeshapeTransform1 = 207,
    ChangeshapeTransform2 = 208,
    ChangeshapeTransform3 = 209,
    ChangeshapeTransform4 = 210,
    RoCounterTraspie = 215,
    RoGhostReflect = 217,
    ChangeshapeTransform5 = 218,
    IceElementaldestroy = 219,
    DragonUltimate = 700,
    ChangeHalloween = 1000,
    BrY1AccessoryRRing = 10001,
    BrY1AccessoryEarring = 10002,
    BrY1AccessoryNeckrace = 10003,
    BrY2AccessoryRRing = 10004,
    BrY2AccessoryEarring = 10005,
    BrY2AccessoryNeckrace = 10006,
    BrY3AccessoryRRing = 10007,
    BrY3AccessoryEarring = 10008,
    BrY3AccessoryNeckrace = 10009,
}

impl TryFrom<&str> for AbnormalVisualEffect {
    type Error = &'static str;

    fn try_from(s: &str) -> Result<Self, Self::Error> {
        let key = s.to_ascii_lowercase();
        for variant in AbnormalVisualEffect::iter() {
            if variant.to_string().to_ascii_lowercase() == key {
                return Ok(variant);
            }
        }
        Err("Unknown abnormal effect")
    }
}
